
import { DailyLog, Grade } from '../types';

// ุงูุชุญูุงุช ุงูุงูุชุชุงุญูุฉ
const GREETINGS = [
  "ุงูุณูุงู ุนูููู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชูุ ุญูุงูู ุงููู ููู ุฃูุฑ ุงูุทุงูุจ ุงููุฌุชูุฏ {name} ๐น",
  "ุชุญูุฉ ุทูุจุฉ ูุจุงุฑูุฉุ ูุฑุณู ุฅูููู ุชูุฑูุฑ ุจุทููุง ุงููุฑุขูู {name} ููุฐุง ุงูููู ๐",
  "ุฃููุงู ุจูู ููู ุฃูุฑ ุงูุทุงูุจ {name}ุ ุฅูููู ุจุดุฑู ูุณุชูู ุงุจููู ุงูููู ูู ุงูุญููุฉ ๐",
  "ุงูุณูุงู ุนููููุ ูุถุน ุจูู ุฃูุฏููู ุญุตุงุฏ ุงูููู ูุงุจููุง ุงููุจุงุฑู {name} ๐",
  "ุญูุงูู ุงูููุ ุฅูููู ููุฌุฒุงู ุนู ุฅูุฌุงุฒ ุงูุจุทู {name} ูู ุญููุฉ ุงูููู โจ",
  "ุฃุณุนุฏ ุงููู ุฃููุงุชูู ุจูู ุฎูุฑุ ุชูุฑูุฑ ูููู ุนู ุฃุฏุงุก ุงูุงุจู {name} ๐"
];

// ุงูุฑุณุงุฆู ุจูุงุกู ุนูู ุงูุชูุฏูุฑ - ุชู ุงูุชุญุฏูุซ ุญุณุจ ุงูุทูุจ
const BODY_BY_GRADE = {
  // ุฑุณุงุฆู ุฌูููุฉ ุฌุฏุงู ููุญูุฒุฉ ูููุฎุฑ
  [Grade.EXCELLENT]: [
    "๐ ูุง ุดุงุก ุงููู ูุง ููุฉ ุฅูุง ุจุงููู! ุฃุฏุงุก {name} ุงูููู ูุงู ูุงูุชุงุฌ ุงููุฑุตุนุ ุชูุงูุฉ ูุชููุฉ ูุญูุธ ุฑุงุณุฎ ูุซูุฌ ุงูุตุฏุฑ.",
    "๐ ูููุฆุงู ููู ูุฐุง ุงูุบุฑุณ ุงููุจุงุฑู. {name} ุฃุจุฏุน ุงูููู ูุฃุณูุนูุง ุขูุงุช ุงููู ุบุถุฉ ุทุฑูุฉ ููุง ุฃูุฒูุชุ ูุณุชูู ููุชุงุฒ ููุดุฑู.",
    "๐ ูุณุชุญู {name} ุงูููู ููุจ 'ูุฌู ุงูุญููุฉ' ุจูุง ููุงุฒุน. ุซูุฉ ุนุงููุฉุ ูุฎุงุฑุฌ ุญุฑูู ูุงุถุญุฉุ ูุญูุธ ูุชูู. ุจุงุฑู ุงููู ูู ุฌููุฏูู.",
    "โจ ุชูุงูุฉ ุงูููู ูุงูุช ููุฑุงู ุนูู ููุฑ. {name} ูุณูุฑ ุจุฎุทู ุงููุงุซู ูุญู ุงูุฎุชู ุจุฅุชูุงูุ ุฒุงุฏูู ุงููู ูู ูุถูู.",
    "๐น ูุฑุฉ ุนูู ููู ูููุง. ุฃุฏุงุก ููุชุงุฒ ูุนูุณ ุงูุชูุงูุงู ููุฒููุงู ุฑุงุฆุนุงู ูุญุฑุตุงู ูู ุงูุทุงูุจ. ุงุณุชูุฑูุง ุนูู ูุฐุง ุงููููุงู ุงูุฑุงุฆุน.",
    "๐ ููุฉ ุชูุงุทุญ ุงูุณุญุงุจ! ุชุณููุน ูุชูู ุฌุฏุงู ููุง ุบูุทุฉุ ูุณุฃู ุงููู ุฃู ูุณุชุนููู ูู ุทุงุนุชู ูุฃู ูุฌุนูู ูู ุฃุฆูุฉ ุงูุญุฑู."
  ],
  [Grade.VERY_GOOD]: [
    "๐ฟ ูุณุชูู ุฑุงุฆุน ููุจุดุฑ ุฌุฏุงู. {name} ูุฏู ุฃุฏุงุกู ูููุงู ุงููููุ ุชูุงูุฉ ุฎุงุดุนุฉ ูุญูุธ ููุถุจุทุ ูู ููุตูู ุนู ุงูุงูุชูุงุฒ ุฅูุง ุงููููู.",
    "๐ ุฃุญุณูุช ูุง ุจุทู! ุฃุฏุงุก {name} ุงูููู ูุณุฑ ุงูุฎุงุทุฑุ ุฌูุฏ ูุงุถุญ ูุชุฑููุฒ ุนุงูู. ุญูุธูู ุงููู ูุฑุนุงูู.",
    "๐ ุจุฏุงูุฉ ูููุฒุฉ ูุญูุธ ุทูุจ. {name} ููุฏู ูุณุชููุงุช ุฑุงุฆุนุฉุ ูุจูููู ูู ุงููุฑุงุฌุนุฉ ุงูุฅุถุงููุฉ ุณูุตุจุญ ุงูุญูุธ ูุงูููุด ูู ุงูุญุฌุฑ.",
    "๐บ ุจูุฑูุช ุงูุฌููุฏ. ูุณุชูู {name} ุงูููู ุฌูุฏ ุฌุฏุงูุ ููุทูุญ ุฃู ูุฑุงู ุฏุงุฆูุงู ูู ุงูููุฉ. ุดูุฑุงู ููุชุงุจุนุชูู.",
    "โจ ุชูุงูุฉ ูุฏูุฉ ูุฃุฏุงุก ูุชุฒู. {name} ูุฑูุจ ุฌุฏุงู ูู ุงูุชููุฒ ุงููุงููุ ููุท ูุญุชุงุฌ ูุชุซุจูุช ุจุนุถ ุงูููุงุถุน ุงูุจุณูุทุฉ."
  ],
  // ุฑุณุงุฆู "ุดุฏ ุงูููุฉ" ูุงูุชุญููุฒ ุงูููู
  [Grade.GOOD]: [
    "๐ช ูุง ุจุทู! ูุณุชูุงู ุงูููู (ุฌูุฏ) ูููููุง ูุนูู ุฃู ูุฏูู ูุฏุฑุงุช ุฃูุจุฑ ุจูุซูุฑ. ุดุฏ ุงูููุฉ ูุฑุงุฌุน ุฃูุซุฑ ูุชุนูุฏ ููููุฏูุฉ.",
    "๐ฅ ููุชู ูุนูุง ูุง {name}! ุงูุญูุธ ููุฌูุฏ ูููู ูุญุชุงุฌ ูุชุฑููุฒ ูุชุซุจูุช. ูุง ุชุฑุถู ุฅูุง ุจุงูุงูุชูุงุฒ ูู ุงููุฑุฉ ุงููุงุฏูุฉ.",
    "๐ {name} ููุชูู ุฐูุงุกู ูุญุฑุตุงูุ ููู ุฃุฏุงุก ุงูููู ูุญุชุงุฌ ูุฏูุนุฉ ุฃููู ูู ุงููุฑุงุฌุนุฉ. ููุชุธุฑ ููู ุงูุฃูุถู ุบุฏุงู ุจุฅุฐู ุงููู.",
    "๐ ุชูุจูู ูุญุจ: ูุณุชูู ุงูููู ูุง ูุนูุณ ูุฏุฑุงุช {name} ุงูุญููููุฉ. ูุฑุฌู ุชูุซูู ุงูุชูุฑุงุฑ ูู ุงูููุฒูุ ูุฃูุช ูุงุฏุฑ ุนูู ุงูุชููุฒ.",
    "๐ก ุจุฐู ุฌูุฏุงู ุทูุจุงูุ ููู ุงูุชุฑุฏุฏ ูุงู ุญุงุถุฑุงู. ูุง ุจุทูุ ุงููุฑุขู ูุญุชุงุฌ ูุชุนุงูุฏุ ูุฑูุฏ ุฃู ูุณูุน ุชูุงูุฉ ุงูุทูุงููุฉ ุบุฏุงู.",
    "โก ุดุฏ ุญููู! ูุณุชูู (ุฌูุฏ) ูุง ูููู ุจุทููุญูุง ูู. ูุซู ุฃูู ุณุชุฑุงุฌุน ุจููุฉ ูุชุฃุชููุง ุบุฏุงู ุจุญูุธ ูุชูู."
  ],
  // ุฑุณุงุฆู ุชุดุฌูุนูุฉ ุนุงุฏูุฉ ูุฏุนู
  [Grade.ACCEPTABLE]: [
    "๐ค ูุง ุจุฃุณุ ููู ุฌูุงุฏ ูุจูุฉ. ูุณุชูู ุงูููู ูุญุชุงุฌ ููููุฉ ูุฑุงุฌุนุฉ ุฌุงุฏุฉ. ูุฑุฌู ูููู ูุณุงุนุฏุฉ {name} ูุชุฏุงุฑู ูุง ูุงุช.",
    "๐ฑ ุงูุญูุธ ุงูููู ูุงู ููุฒูุฒุงู ููููุงู. ุงููุฑุขู ุนุฒูุฒ ููุชููุช ุฅู ูู ูุฑุงุฌุนู. ูุซู ุจุญุฑุตูู ุนูู ูุชุงุจุนุชู.",
    "๐งก {name} ูุญุชุงุฌ ูุฏุนููู ูุชุดุฌูุนูู. ุงูุฃุฏุงุก ููุจูู ูููู ูุฎุดู ุนููู ูู ุชุฑุงูู ุงูุญูุธ ุบูุฑ ุงููุชูู. ููุชูู ูุนูุง.",
    "๐ ูุฑุฌู ุนุฏู ุชุฌุงูุฒ ุงูููุฑุฑ ุงูุญุงูู ุฅูุง ุจุนุฏ ุฅุชูุงูู ุชูุงูุงู. ุฃุฏุงุก ุงูููู ูุชุทูุจ ุฅุนุงุฏุฉ ูุชูุฑุงุฑุงู ูุซูุฑุงู.",
    "๐ ูููุช ุนูุงูุชูู ุงููุฑููุฉ ูุชูุซูู ุงููุฑุงุฌุนุฉ ูุน {name}ุ ุงูููุช ุซููู ููุฑูุฏ ุงุณุชุบูุงูู ูู ุงูุชูุฏู ูููุณ ุงูุฅุนุงุฏุฉ."
  ],
  [Grade.NEEDS_WORK]: [
    "๐ ุชููู ูููุฑุงุฌุนุฉ. ููุฃุณู {name} ูู ูุชููู ูู ุงูุชุณููุน ุงูููู. ูุฑุฌู ูููู ุงูุฌููุณ ูุนู ูุงูุชุฃูุฏ ูู ุญูุธู ูุจู ุงูุญุถูุฑ.",
    "๐ ูุญุชุงุฌ ูุฅุนุงุฏุฉ ุงููุฑุฏ ุงููููู. ุงูุจูุงุก ุงูููู ูุญุชุงุฌ ูุฃุณุงุณ ูููุ ูุญูุธ ุงูููู ูู ููู ุฌุงูุฒุงู.",
    "โ๏ธ ูุฑุฌู ุชุฏุงุฑู ุงูุฃูุฑ. ุงูุทุงูุจ ุจุญุงุฌุฉ ูุงุณุฉ ูููุชุงุจุนุฉ ุงูููุฒููุฉ ุงูุฏูููุฉุ ูุณุชูุงู ุงูููู ูุชุทูุจ ุชุฏุฎูุงู ูููู.",
    "๐ ุงููุฑุงุฌุนุฉ ูู ุงูุจูุช ูู ุงูุฃุณุงุณ. ูุฑุฌู ูุณุงุนุฏุฉ {name} ูู ุชูุธูู ููุชู ูุชุฎุตูุต ููุช ุซุงุจุช ููุญูุธ.",
    "๐ช ูุง ุชูุฃุณ ูุง ุจุทูุ ูููู ูุฌุจ ุฃู ุชุฌุชูุฏ ุฃูุซุฑ. ููุชุธุฑ ููู ุบุฏุงู ุญูุธุงู ููุชุงุฒุงู ูุชุนููุถ ุงูููู."
  ]
};

// ุงูุฃุฏุนูุฉ ุงูุฎุงุชูุฉ ูููุงูุฏูู ูุงูุทุงูุจ
const CLOSINGS = [
  "ูุณุฃู ุงููู ุฃู ููุฑ ุฃุนูููู ุจูุ ูุฃู ูุฌุนูู ูู ุญูุธุฉ ูุชุงุจู ุงูุนุงูููู ุจูุ ูุฌุฒุงูู ุงููู ุฎูุฑุงู ุนูู ุญุณู ูุชุงุจุนุชูู. ๐คฒ",
  "ุจุงุฑู ุงููู ูููู ููู ุฐุฑูุชููุ ูุฌุนู ุงููุฑุขู ุดููุนุงู ููู ููู ููู ุงูููุงูุฉ. ุดูุฑุงู ูุงูุชูุงููู. โจ",
  "ุงูููู ุฃูุจุชู ูุจุงุชุงู ุญุณูุงู ูุงุฌุนูู ูุฑุฉ ุนูู ููุงูุฏูู. ุดูุฑ ุงููู ุณุนููู ููุชุจ ุฃุฌุฑูู. ๐ท",
  "ุฒุงุฏูู ุงููู ุญุฑุตุงู ูุชููููุงูุ ูุฃูุจุณูู ุจู ุชุงุฌ ุงูููุงุฑ ููู ุงูููุงูุฉ. ุฏูุชู ูู ุญูุธ ุงููู. ๐",
  "ุฌุนู ุงููู ุงููุฑุขู ุฑุจูุน ููุจู ูููุฑ ุตุฏุฑูุ ููุชุจ ููู ุงูุฃุฌุฑ ูุงููุซูุจุฉ. ๐ฟ",
  "ุดูุฑ ุงููู ุณุนูููุ ูุฃุนุงููุง ูุฅูุงูู ุนูู ุญูู ูุฐู ุงูุฃูุงูุฉ ุงูุนุธููุฉ. ๐"
];

const DEFAULT_BODIES = [
    "ูุณุฃู ุงููู ุฃู ูุฌุนูู ูู ุฃูู ุงููุฑุขู. ูุฑุฌู ุงูุงุณุชูุฑุงุฑ ูู ุงููุฑุงุฌุนุฉ ูุงูุงูุชูุงู ุจุงููุฑุฏ ุงููููู.",
    "ุจุงุฑู ุงููู ูู ุงูุฌููุฏ ุงููุจุฐููุฉุ ููุชุธุฑ ุงููุฒูุฏ ูู ุงูุชูุฏู ูุงูุชุฑููุฒ ูู ุงูุญุตุต ุงููุงุฏูุฉ.",
    "ูุณูุฑ ุจุฎุทู ุทูุจุฉุ ููุญุชุงุฌ ูุชุนุงูููู ุงููุณุชูุฑ ูููุตูู ูููุฏู ุงูููุดูุฏ."
];

export const generateEncouragement = async (studentName: string, log: DailyLog): Promise<string> => {
  // 1. ุงุฎุชูุงุฑ ุงูุชุญูุฉ
  const greetingTemplate = GREETINGS[Math.floor(Math.random() * GREETINGS.length)];
  const greeting = greetingTemplate.replace("{name}", studentName);

  // 2. ุชุญุฏูุฏ ุงูุชูุฏูุฑ ูุงุฎุชูุงุฑ ูุต ุงูุฑุณุงูุฉ
  let grade = log.jadeed?.grade;
  
  // If no main grade (e.g. MULTI with undefined top-level), try to find an average or first grade from multiSurahs
  if (!grade && log.jadeed?.type === 'MULTI' && log.jadeed.multiSurahs && log.jadeed.multiSurahs.length > 0) {
      grade = log.jadeed.multiSurahs[0].grade;
  }

  if ((!grade || grade === undefined) && log.murajaah && log.murajaah.length > 0) {
      grade = log.murajaah[0].grade;
      if (!grade && log.murajaah[0].type === 'MULTI' && log.murajaah[0].multiSurahs) {
          grade = log.murajaah[0].multiSurahs[0]?.grade;
      }
  }

  let bodyTemplate = "";
  if (!grade) {
      bodyTemplate = DEFAULT_BODIES[Math.floor(Math.random() * DEFAULT_BODIES.length)];
  } else {
      const bodies = BODY_BY_GRADE[grade] || DEFAULT_BODIES;
      bodyTemplate = bodies[Math.floor(Math.random() * bodies.length)];
  }
  const body = bodyTemplate.replace("{name}", studentName);

  // 3. ุงุฎุชูุงุฑ ุงูุฎุงุชูุฉ ูุงูุฏุนุงุก
  const closing = CLOSINGS[Math.floor(Math.random() * CLOSINGS.length)];

  // ุชุฌููุน ุงูุฑุณุงูุฉ
  return `${greeting}\n\n${body}\n\n${closing}`;
};
